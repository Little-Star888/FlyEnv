"use strict";var Kn=Object.create;var xe=Object.defineProperty;var Gn=Object.getOwnPropertyDescriptor;var Qn=Object.getOwnPropertyNames;var Vn=Object.getPrototypeOf,zn=Object.prototype.hasOwnProperty;var U=(e,t)=>()=>(e&&(t=e(e=0)),t);var p=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Y=(e,t)=>{for(var r in t)xe(e,r,{get:t[r],enumerable:!0})},yt=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of Qn(t))!zn.call(e,i)&&i!==r&&xe(e,i,{get:()=>t[i],enumerable:!(n=Gn(t,i))||n.enumerable});return e};var Xn=(e,t,r)=>(r=e!=null?Kn(Vn(e)):{},yt(t||!e||!e.__esModule?xe(r,"default",{value:e,enumerable:!0}):r,e)),Zn=e=>yt(xe({},"__esModule",{value:!0}),e);var C=p(_e=>{"use strict";_e.fromCallback=function(e){return Object.defineProperty(function(...t){if(typeof t[t.length-1]=="function")e.apply(this,t);else return new Promise((r,n)=>{t.push((i,o)=>i!=null?n(i):r(o)),e.apply(this,t)})},"name",{value:e.name})};_e.fromPromise=function(e){return Object.defineProperty(function(...t){let r=t[t.length-1];if(typeof r!="function")return e.apply(this,t);t.pop(),e.apply(this,t).then(n=>r(null,n),r)},"name",{value:e.name})}});var ht=p((Ss,dt)=>{var Z=require("constants"),ei=process.cwd,Pe=null,ti=process.env.GRACEFUL_FS_PLATFORM||process.platform;process.cwd=function(){return Pe||(Pe=ei.call(process)),Pe};try{process.cwd()}catch{}typeof process.chdir=="function"&&(Re=process.chdir,process.chdir=function(e){Pe=null,Re.call(process,e)},Object.setPrototypeOf&&Object.setPrototypeOf(process.chdir,Re));var Re;dt.exports=ri;function ri(e){Z.hasOwnProperty("O_SYMLINK")&&process.version.match(/^v0\.6\.[0-2]|^v0\.5\./)&&t(e),e.lutimes||r(e),e.chown=o(e.chown),e.fchown=o(e.fchown),e.lchown=o(e.lchown),e.chmod=n(e.chmod),e.fchmod=n(e.fchmod),e.lchmod=n(e.lchmod),e.chownSync=s(e.chownSync),e.fchownSync=s(e.fchownSync),e.lchownSync=s(e.lchownSync),e.chmodSync=i(e.chmodSync),e.fchmodSync=i(e.fchmodSync),e.lchmodSync=i(e.lchmodSync),e.stat=a(e.stat),e.fstat=a(e.fstat),e.lstat=a(e.lstat),e.statSync=y(e.statSync),e.fstatSync=y(e.fstatSync),e.lstatSync=y(e.lstatSync),e.chmod&&!e.lchmod&&(e.lchmod=function(c,u,m){m&&process.nextTick(m)},e.lchmodSync=function(){}),e.chown&&!e.lchown&&(e.lchown=function(c,u,m,l){l&&process.nextTick(l)},e.lchownSync=function(){}),ti==="win32"&&(e.rename=typeof e.rename!="function"?e.rename:function(c){function u(m,l,d){var P=Date.now(),v=0;c(m,l,function E(J){if(J&&(J.code==="EACCES"||J.code==="EPERM"||J.code==="EBUSY")&&Date.now()-P<6e4){setTimeout(function(){e.stat(l,function(I,fe){I&&I.code==="ENOENT"?c(m,l,E):d(J)})},v),v<100&&(v+=10);return}d&&d(J)})}return Object.setPrototypeOf&&Object.setPrototypeOf(u,c),u}(e.rename)),e.read=typeof e.read!="function"?e.read:function(c){function u(m,l,d,P,v,E){var J;if(E&&typeof E=="function"){var I=0;J=function(fe,ft,mt){if(fe&&fe.code==="EAGAIN"&&I<10)return I++,c.call(e,m,l,d,P,v,J);E.apply(this,arguments)}}return c.call(e,m,l,d,P,v,J)}return Object.setPrototypeOf&&Object.setPrototypeOf(u,c),u}(e.read),e.readSync=typeof e.readSync!="function"?e.readSync:function(c){return function(u,m,l,d,P){for(var v=0;;)try{return c.call(e,u,m,l,d,P)}catch(E){if(E.code==="EAGAIN"&&v<10){v++;continue}throw E}}}(e.readSync);function t(c){c.lchmod=function(u,m,l){c.open(u,Z.O_WRONLY|Z.O_SYMLINK,m,function(d,P){if(d){l&&l(d);return}c.fchmod(P,m,function(v){c.close(P,function(E){l&&l(v||E)})})})},c.lchmodSync=function(u,m){var l=c.openSync(u,Z.O_WRONLY|Z.O_SYMLINK,m),d=!0,P;try{P=c.fchmodSync(l,m),d=!1}finally{if(d)try{c.closeSync(l)}catch{}else c.closeSync(l)}return P}}function r(c){Z.hasOwnProperty("O_SYMLINK")&&c.futimes?(c.lutimes=function(u,m,l,d){c.open(u,Z.O_SYMLINK,function(P,v){if(P){d&&d(P);return}c.futimes(v,m,l,function(E){c.close(v,function(J){d&&d(E||J)})})})},c.lutimesSync=function(u,m,l){var d=c.openSync(u,Z.O_SYMLINK),P,v=!0;try{P=c.futimesSync(d,m,l),v=!1}finally{if(v)try{c.closeSync(d)}catch{}else c.closeSync(d)}return P}):c.futimes&&(c.lutimes=function(u,m,l,d){d&&process.nextTick(d)},c.lutimesSync=function(){})}function n(c){return c&&function(u,m,l){return c.call(e,u,m,function(d){g(d)&&(d=null),l&&l.apply(this,arguments)})}}function i(c){return c&&function(u,m){try{return c.call(e,u,m)}catch(l){if(!g(l))throw l}}}function o(c){return c&&function(u,m,l,d){return c.call(e,u,m,l,function(P){g(P)&&(P=null),d&&d.apply(this,arguments)})}}function s(c){return c&&function(u,m,l){try{return c.call(e,u,m,l)}catch(d){if(!g(d))throw d}}}function a(c){return c&&function(u,m,l){typeof m=="function"&&(l=m,m=null);function d(P,v){v&&(v.uid<0&&(v.uid+=4294967296),v.gid<0&&(v.gid+=4294967296)),l&&l.apply(this,arguments)}return m?c.call(e,u,m,d):c.call(e,u,d)}}function y(c){return c&&function(u,m){var l=m?c.call(e,u,m):c.call(e,u);return l&&(l.uid<0&&(l.uid+=4294967296),l.gid<0&&(l.gid+=4294967296)),l}}function g(c){if(!c||c.code==="ENOSYS")return!0;var u=!process.getuid||process.getuid()!==0;return!!(u&&(c.code==="EINVAL"||c.code==="EPERM"))}}});var St=p((vs,wt)=>{var pt=require("stream").Stream;wt.exports=ni;function ni(e){return{ReadStream:t,WriteStream:r};function t(n,i){if(!(this instanceof t))return new t(n,i);pt.call(this);var o=this;this.path=n,this.fd=null,this.readable=!0,this.paused=!1,this.flags="r",this.mode=438,this.bufferSize=64*1024,i=i||{};for(var s=Object.keys(i),a=0,y=s.length;a<y;a++){var g=s[a];this[g]=i[g]}if(this.encoding&&this.setEncoding(this.encoding),this.start!==void 0){if(typeof this.start!="number")throw TypeError("start must be a Number");if(this.end===void 0)this.end=1/0;else if(typeof this.end!="number")throw TypeError("end must be a Number");if(this.start>this.end)throw new Error("start must be <= end");this.pos=this.start}if(this.fd!==null){process.nextTick(function(){o._read()});return}e.open(this.path,this.flags,this.mode,function(c,u){if(c){o.emit("error",c),o.readable=!1;return}o.fd=u,o.emit("open",u),o._read()})}function r(n,i){if(!(this instanceof r))return new r(n,i);pt.call(this),this.path=n,this.fd=null,this.writable=!0,this.flags="w",this.encoding="binary",this.mode=438,this.bytesWritten=0,i=i||{};for(var o=Object.keys(i),s=0,a=o.length;s<a;s++){var y=o[s];this[y]=i[y]}if(this.start!==void 0){if(typeof this.start!="number")throw TypeError("start must be a Number");if(this.start<0)throw new Error("start must be >= zero");this.pos=this.start}this.busy=!1,this._queue=[],this.fd===null&&(this._open=e.open,this._queue.push([this._open,this.path,this.flags,this.mode,void 0]),this.flush())}}});var gt=p((gs,vt)=>{"use strict";vt.exports=oi;var ii=Object.getPrototypeOf||function(e){return e.__proto__};function oi(e){if(e===null||typeof e!="object")return e;if(e instanceof Object)var t={__proto__:ii(e)};else var t=Object.create(null);return Object.getOwnPropertyNames(e).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))}),t}});var se=p((xs,je)=>{var b=require("fs"),si=ht(),ci=St(),ai=gt(),ke=require("util"),R,Ee;typeof Symbol=="function"&&typeof Symbol.for=="function"?(R=Symbol.for("graceful-fs.queue"),Ee=Symbol.for("graceful-fs.previous")):(R="___graceful-fs.queue",Ee="___graceful-fs.previous");function ui(){}function kt(e,t){Object.defineProperty(e,R,{get:function(){return t}})}var ne=ui;ke.debuglog?ne=ke.debuglog("gfs4"):/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&(ne=function(){var e=ke.format.apply(ke,arguments);e="GFS4: "+e.split(/\n/).join(`
GFS4: `)});b[R]||(xt=global[R]||[],kt(b,xt),b.close=function(e){function t(r,n){return e.call(b,r,function(i){i||Pt(),typeof n=="function"&&n.apply(this,arguments)})}return Object.defineProperty(t,Ee,{value:e}),t}(b.close),b.closeSync=function(e){function t(r){e.apply(b,arguments),Pt()}return Object.defineProperty(t,Ee,{value:e}),t}(b.closeSync),/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&process.on("exit",function(){ne(b[R]),require("assert").equal(b[R].length,0)}));var xt;global[R]||kt(global,b[R]);je.exports=Me(ai(b));process.env.TEST_GRACEFUL_FS_GLOBAL_PATCH&&!b.__patched&&(je.exports=Me(b),b.__patched=!0);function Me(e){si(e),e.gracefulify=Me,e.createReadStream=ft,e.createWriteStream=mt;var t=e.readFile;e.readFile=r;function r(h,S,w){return typeof S=="function"&&(w=S,S=null),T(h,S,w);function T(L,D,q,O){return t(L,D,function(x){x&&(x.code==="EMFILE"||x.code==="ENFILE")?oe([T,[L,D,q],x,O||Date.now(),Date.now()]):typeof q=="function"&&q.apply(this,arguments)})}}var n=e.writeFile;e.writeFile=i;function i(h,S,w,T){return typeof w=="function"&&(T=w,w=null),L(h,S,w,T);function L(D,q,O,x,_){return n(D,q,O,function(k){k&&(k.code==="EMFILE"||k.code==="ENFILE")?oe([L,[D,q,O,x],k,_||Date.now(),Date.now()]):typeof x=="function"&&x.apply(this,arguments)})}}var o=e.appendFile;o&&(e.appendFile=s);function s(h,S,w,T){return typeof w=="function"&&(T=w,w=null),L(h,S,w,T);function L(D,q,O,x,_){return o(D,q,O,function(k){k&&(k.code==="EMFILE"||k.code==="ENFILE")?oe([L,[D,q,O,x],k,_||Date.now(),Date.now()]):typeof x=="function"&&x.apply(this,arguments)})}}var a=e.copyFile;a&&(e.copyFile=y);function y(h,S,w,T){return typeof w=="function"&&(T=w,w=0),L(h,S,w,T);function L(D,q,O,x,_){return a(D,q,O,function(k){k&&(k.code==="EMFILE"||k.code==="ENFILE")?oe([L,[D,q,O,x],k,_||Date.now(),Date.now()]):typeof x=="function"&&x.apply(this,arguments)})}}var g=e.readdir;e.readdir=u;var c=/^v[0-5]\./;function u(h,S,w){typeof S=="function"&&(w=S,S=null);var T=c.test(process.version)?function(q,O,x,_){return g(q,L(q,O,x,_))}:function(q,O,x,_){return g(q,O,L(q,O,x,_))};return T(h,S,w);function L(D,q,O,x){return function(_,k){_&&(_.code==="EMFILE"||_.code==="ENFILE")?oe([T,[D,q,O],_,x||Date.now(),Date.now()]):(k&&k.sort&&k.sort(),typeof O=="function"&&O.call(this,_,k))}}}if(process.version.substr(0,4)==="v0.8"){var m=ci(e);E=m.ReadStream,I=m.WriteStream}var l=e.ReadStream;l&&(E.prototype=Object.create(l.prototype),E.prototype.open=J);var d=e.WriteStream;d&&(I.prototype=Object.create(d.prototype),I.prototype.open=fe),Object.defineProperty(e,"ReadStream",{get:function(){return E},set:function(h){E=h},enumerable:!0,configurable:!0}),Object.defineProperty(e,"WriteStream",{get:function(){return I},set:function(h){I=h},enumerable:!0,configurable:!0});var P=E;Object.defineProperty(e,"FileReadStream",{get:function(){return P},set:function(h){P=h},enumerable:!0,configurable:!0});var v=I;Object.defineProperty(e,"FileWriteStream",{get:function(){return v},set:function(h){v=h},enumerable:!0,configurable:!0});function E(h,S){return this instanceof E?(l.apply(this,arguments),this):E.apply(Object.create(E.prototype),arguments)}function J(){var h=this;Le(h.path,h.flags,h.mode,function(S,w){S?(h.autoClose&&h.destroy(),h.emit("error",S)):(h.fd=w,h.emit("open",w),h.read())})}function I(h,S){return this instanceof I?(d.apply(this,arguments),this):I.apply(Object.create(I.prototype),arguments)}function fe(){var h=this;Le(h.path,h.flags,h.mode,function(S,w){S?(h.destroy(),h.emit("error",S)):(h.fd=w,h.emit("open",w))})}function ft(h,S){return new e.ReadStream(h,S)}function mt(h,S){return new e.WriteStream(h,S)}var Yn=e.open;e.open=Le;function Le(h,S,w,T){return typeof w=="function"&&(T=w,w=null),L(h,S,w,T);function L(D,q,O,x,_){return Yn(D,q,O,function(k,hs){k&&(k.code==="EMFILE"||k.code==="ENFILE")?oe([L,[D,q,O,x],k,_||Date.now(),Date.now()]):typeof x=="function"&&x.apply(this,arguments)})}}return e}function oe(e){ne("ENQUEUE",e[0].name,e[1]),b[R].push(e),Ie()}var Fe;function Pt(){for(var e=Date.now(),t=0;t<b[R].length;++t)b[R][t].length>2&&(b[R][t][3]=e,b[R][t][4]=e);Ie()}function Ie(){if(clearTimeout(Fe),Fe=void 0,b[R].length!==0){var e=b[R].shift(),t=e[0],r=e[1],n=e[2],i=e[3],o=e[4];if(i===void 0)ne("RETRY",t.name,r),t.apply(null,r);else if(Date.now()-i>=6e4){ne("TIMEOUT",t.name,r);var s=r.pop();typeof s=="function"&&s.call(null,n)}else{var a=Date.now()-o,y=Math.max(o-i,1),g=Math.min(y*1.2,100);a>=g?(ne("RETRY",t.name,r),t.apply(null,r.concat([i]))):b[R].push(e)}Fe===void 0&&(Fe=setTimeout(Ie,0))}}});var A=p(z=>{"use strict";var Ft=C().fromCallback,j=se(),li=["access","appendFile","chmod","chown","close","copyFile","cp","fchmod","fchown","fdatasync","fstat","fsync","ftruncate","futimes","glob","lchmod","lchown","lutimes","link","lstat","mkdir","mkdtemp","open","opendir","readdir","readFile","readlink","realpath","rename","rm","rmdir","stat","statfs","symlink","truncate","unlink","utimes","writeFile"].filter(e=>typeof j[e]=="function");Object.assign(z,j);li.forEach(e=>{z[e]=Ft(j[e])});z.exists=function(e,t){return typeof t=="function"?j.exists(e,t):new Promise(r=>j.exists(e,r))};z.read=function(e,t,r,n,i,o){return typeof o=="function"?j.read(e,t,r,n,i,o):new Promise((s,a)=>{j.read(e,t,r,n,i,(y,g,c)=>{if(y)return a(y);s({bytesRead:g,buffer:c})})})};z.write=function(e,t,...r){return typeof r[r.length-1]=="function"?j.write(e,t,...r):new Promise((n,i)=>{j.write(e,t,...r,(o,s,a)=>{if(o)return i(o);n({bytesWritten:s,buffer:a})})})};z.readv=function(e,t,...r){return typeof r[r.length-1]=="function"?j.readv(e,t,...r):new Promise((n,i)=>{j.readv(e,t,...r,(o,s,a)=>{if(o)return i(o);n({bytesRead:s,buffers:a})})})};z.writev=function(e,t,...r){return typeof r[r.length-1]=="function"?j.writev(e,t,...r):new Promise((n,i)=>{j.writev(e,t,...r,(o,s,a)=>{if(o)return i(o);n({bytesWritten:s,buffers:a})})})};typeof j.realpath.native=="function"?z.realpath.native=Ft(j.realpath.native):process.emitWarning("fs.realpath.native is not a function. Is fs being monkey-patched?","Warning","fs-extra-WARN0003")});var qt=p((ks,Et)=>{"use strict";var fi=require("path");Et.exports.checkPath=function(t){if(process.platform==="win32"&&/[<>:"|?*]/.test(t.replace(fi.parse(t).root,""))){let n=new Error(`Path contains invalid characters: ${t}`);throw n.code="EINVAL",n}}});var Dt=p((Fs,Ae)=>{"use strict";var bt=A(),{checkPath:$t}=qt(),Ot=e=>{let t={mode:511};return typeof e=="number"?e:{...t,...e}.mode};Ae.exports.makeDir=async(e,t)=>($t(e),bt.mkdir(e,{mode:Ot(t),recursive:!0}));Ae.exports.makeDirSync=(e,t)=>($t(e),bt.mkdirSync(e,{mode:Ot(t),recursive:!0}))});var G=p((Es,Ct)=>{"use strict";var mi=C().fromPromise,{makeDir:yi,makeDirSync:We}=Dt(),Be=mi(yi);Ct.exports={mkdirs:Be,mkdirsSync:We,mkdirp:Be,mkdirpSync:We,ensureDir:Be,ensureDirSync:We}});var ee=p((qs,Tt)=>{"use strict";var di=C().fromPromise,Nt=A();function hi(e){return Nt.access(e).then(()=>!0).catch(()=>!1)}Tt.exports={pathExists:di(hi),pathExistsSync:Nt.existsSync}});var Je=p((bs,Lt)=>{"use strict";var ce=A(),pi=C().fromPromise;async function wi(e,t,r){let n=await ce.open(e,"r+"),i=null;try{await ce.futimes(n,t,r)}finally{try{await ce.close(n)}catch(o){i=o}}if(i)throw i}function Si(e,t,r){let n=ce.openSync(e,"r+");return ce.futimesSync(n,t,r),ce.closeSync(n)}Lt.exports={utimesMillis:pi(wi),utimesMillisSync:Si}});var ie=p(($s,It)=>{"use strict";var ae=A(),N=require("path"),_t=C().fromPromise;function vi(e,t,r){let n=r.dereference?i=>ae.stat(i,{bigint:!0}):i=>ae.lstat(i,{bigint:!0});return Promise.all([n(e),n(t).catch(i=>{if(i.code==="ENOENT")return null;throw i})]).then(([i,o])=>({srcStat:i,destStat:o}))}function gi(e,t,r){let n,i=r.dereference?s=>ae.statSync(s,{bigint:!0}):s=>ae.lstatSync(s,{bigint:!0}),o=i(e);try{n=i(t)}catch(s){if(s.code==="ENOENT")return{srcStat:o,destStat:null};throw s}return{srcStat:o,destStat:n}}async function xi(e,t,r,n){let{srcStat:i,destStat:o}=await vi(e,t,n);if(o){if(me(i,o)){let s=N.basename(e),a=N.basename(t);if(r==="move"&&s!==a&&s.toLowerCase()===a.toLowerCase())return{srcStat:i,destStat:o,isChangingCase:!0};throw new Error("Source and destination must not be the same.")}if(i.isDirectory()&&!o.isDirectory())throw new Error(`Cannot overwrite non-directory '${t}' with directory '${e}'.`);if(!i.isDirectory()&&o.isDirectory())throw new Error(`Cannot overwrite directory '${t}' with non-directory '${e}'.`)}if(i.isDirectory()&&Ue(e,t))throw new Error(qe(e,t,r));return{srcStat:i,destStat:o}}function Pi(e,t,r,n){let{srcStat:i,destStat:o}=gi(e,t,n);if(o){if(me(i,o)){let s=N.basename(e),a=N.basename(t);if(r==="move"&&s!==a&&s.toLowerCase()===a.toLowerCase())return{srcStat:i,destStat:o,isChangingCase:!0};throw new Error("Source and destination must not be the same.")}if(i.isDirectory()&&!o.isDirectory())throw new Error(`Cannot overwrite non-directory '${t}' with directory '${e}'.`);if(!i.isDirectory()&&o.isDirectory())throw new Error(`Cannot overwrite directory '${t}' with non-directory '${e}'.`)}if(i.isDirectory()&&Ue(e,t))throw new Error(qe(e,t,r));return{srcStat:i,destStat:o}}async function Rt(e,t,r,n){let i=N.resolve(N.dirname(e)),o=N.resolve(N.dirname(r));if(o===i||o===N.parse(o).root)return;let s;try{s=await ae.stat(o,{bigint:!0})}catch(a){if(a.code==="ENOENT")return;throw a}if(me(t,s))throw new Error(qe(e,r,n));return Rt(e,t,o,n)}function Mt(e,t,r,n){let i=N.resolve(N.dirname(e)),o=N.resolve(N.dirname(r));if(o===i||o===N.parse(o).root)return;let s;try{s=ae.statSync(o,{bigint:!0})}catch(a){if(a.code==="ENOENT")return;throw a}if(me(t,s))throw new Error(qe(e,r,n));return Mt(e,t,o,n)}function me(e,t){return t.ino&&t.dev&&t.ino===e.ino&&t.dev===e.dev}function Ue(e,t){let r=N.resolve(e).split(N.sep).filter(i=>i),n=N.resolve(t).split(N.sep).filter(i=>i);return r.every((i,o)=>n[o]===i)}function qe(e,t,r){return`Cannot ${r} '${e}' to a subdirectory of itself, '${t}'.`}It.exports={checkPaths:_t(xi),checkPathsSync:Pi,checkParentPaths:_t(Rt),checkParentPathsSync:Mt,isSrcSubdir:Ue,areIdentical:me}});var Jt=p((Os,Bt)=>{"use strict";var M=A(),ye=require("path"),{mkdirs:ki}=G(),{pathExists:Fi}=ee(),{utimesMillis:Ei}=Je(),de=ie();async function qi(e,t,r={}){typeof r=="function"&&(r={filter:r}),r.clobber="clobber"in r?!!r.clobber:!0,r.overwrite="overwrite"in r?!!r.overwrite:r.clobber,r.preserveTimestamps&&process.arch==="ia32"&&process.emitWarning(`Using the preserveTimestamps option in 32-bit node is not recommended;

	see https://github.com/jprichardson/node-fs-extra/issues/269`,"Warning","fs-extra-WARN0001");let{srcStat:n,destStat:i}=await de.checkPaths(e,t,"copy",r);if(await de.checkParentPaths(e,n,t,"copy"),!await At(e,t,r))return;let s=ye.dirname(t);await Fi(s)||await ki(s),await Wt(i,e,t,r)}async function At(e,t,r){return r.filter?r.filter(e,t):!0}async function Wt(e,t,r,n){let o=await(n.dereference?M.stat:M.lstat)(t);if(o.isDirectory())return Di(o,e,t,r,n);if(o.isFile()||o.isCharacterDevice()||o.isBlockDevice())return bi(o,e,t,r,n);if(o.isSymbolicLink())return Ci(e,t,r,n);throw o.isSocket()?new Error(`Cannot copy a socket file: ${t}`):o.isFIFO()?new Error(`Cannot copy a FIFO pipe: ${t}`):new Error(`Unknown file: ${t}`)}async function bi(e,t,r,n,i){if(!t)return jt(e,r,n,i);if(i.overwrite)return await M.unlink(n),jt(e,r,n,i);if(i.errorOnExist)throw new Error(`'${n}' already exists`)}async function jt(e,t,r,n){if(await M.copyFile(t,r),n.preserveTimestamps){$i(e.mode)&&await Oi(r,e.mode);let i=await M.stat(t);await Ei(r,i.atime,i.mtime)}return M.chmod(r,e.mode)}function $i(e){return(e&128)===0}function Oi(e,t){return M.chmod(e,t|128)}async function Di(e,t,r,n,i){t||await M.mkdir(n);let o=[];for await(let s of await M.opendir(r)){let a=ye.join(r,s.name),y=ye.join(n,s.name);o.push(At(a,y,i).then(g=>{if(g)return de.checkPaths(a,y,"copy",i).then(({destStat:c})=>Wt(c,a,y,i))}))}await Promise.all(o),t||await M.chmod(n,e.mode)}async function Ci(e,t,r,n){let i=await M.readlink(t);if(n.dereference&&(i=ye.resolve(process.cwd(),i)),!e)return M.symlink(i,r);let o=null;try{o=await M.readlink(r)}catch(s){if(s.code==="EINVAL"||s.code==="UNKNOWN")return M.symlink(i,r);throw s}if(n.dereference&&(o=ye.resolve(process.cwd(),o)),de.isSrcSubdir(i,o))throw new Error(`Cannot copy '${i}' to a subdirectory of itself, '${o}'.`);if(de.isSrcSubdir(o,i))throw new Error(`Cannot overwrite '${o}' with '${i}'.`);return await M.unlink(r),M.symlink(i,r)}Bt.exports=qi});var Gt=p((Ds,Kt)=>{"use strict";var W=se(),he=require("path"),Ni=G().mkdirsSync,Ti=Je().utimesMillisSync,pe=ie();function Li(e,t,r){typeof r=="function"&&(r={filter:r}),r=r||{},r.clobber="clobber"in r?!!r.clobber:!0,r.overwrite="overwrite"in r?!!r.overwrite:r.clobber,r.preserveTimestamps&&process.arch==="ia32"&&process.emitWarning(`Using the preserveTimestamps option in 32-bit node is not recommended;

	see https://github.com/jprichardson/node-fs-extra/issues/269`,"Warning","fs-extra-WARN0002");let{srcStat:n,destStat:i}=pe.checkPathsSync(e,t,"copy",r);if(pe.checkParentPathsSync(e,n,t,"copy"),r.filter&&!r.filter(e,t))return;let o=he.dirname(t);return W.existsSync(o)||Ni(o),Ut(i,e,t,r)}function Ut(e,t,r,n){let o=(n.dereference?W.statSync:W.lstatSync)(t);if(o.isDirectory())return Wi(o,e,t,r,n);if(o.isFile()||o.isCharacterDevice()||o.isBlockDevice())return _i(o,e,t,r,n);if(o.isSymbolicLink())return Ui(e,t,r,n);throw o.isSocket()?new Error(`Cannot copy a socket file: ${t}`):o.isFIFO()?new Error(`Cannot copy a FIFO pipe: ${t}`):new Error(`Unknown file: ${t}`)}function _i(e,t,r,n,i){return t?Ri(e,r,n,i):Ht(e,r,n,i)}function Ri(e,t,r,n){if(n.overwrite)return W.unlinkSync(r),Ht(e,t,r,n);if(n.errorOnExist)throw new Error(`'${r}' already exists`)}function Ht(e,t,r,n){return W.copyFileSync(t,r),n.preserveTimestamps&&Mi(e.mode,t,r),He(r,e.mode)}function Mi(e,t,r){return Ii(e)&&ji(r,e),Ai(t,r)}function Ii(e){return(e&128)===0}function ji(e,t){return He(e,t|128)}function He(e,t){return W.chmodSync(e,t)}function Ai(e,t){let r=W.statSync(e);return Ti(t,r.atime,r.mtime)}function Wi(e,t,r,n,i){return t?Yt(r,n,i):Bi(e.mode,r,n,i)}function Bi(e,t,r,n){return W.mkdirSync(r),Yt(t,r,n),He(r,e)}function Yt(e,t,r){let n=W.opendirSync(e);try{let i;for(;(i=n.readSync())!==null;)Ji(i.name,e,t,r)}finally{n.closeSync()}}function Ji(e,t,r,n){let i=he.join(t,e),o=he.join(r,e);if(n.filter&&!n.filter(i,o))return;let{destStat:s}=pe.checkPathsSync(i,o,"copy",n);return Ut(s,i,o,n)}function Ui(e,t,r,n){let i=W.readlinkSync(t);if(n.dereference&&(i=he.resolve(process.cwd(),i)),e){let o;try{o=W.readlinkSync(r)}catch(s){if(s.code==="EINVAL"||s.code==="UNKNOWN")return W.symlinkSync(i,r);throw s}if(n.dereference&&(o=he.resolve(process.cwd(),o)),pe.isSrcSubdir(i,o))throw new Error(`Cannot copy '${i}' to a subdirectory of itself, '${o}'.`);if(pe.isSrcSubdir(o,i))throw new Error(`Cannot overwrite '${o}' with '${i}'.`);return Hi(i,r)}else return W.symlinkSync(i,r)}function Hi(e,t){return W.unlinkSync(t),W.symlinkSync(e,t)}Kt.exports=Li});var be=p((Cs,Qt)=>{"use strict";var Yi=C().fromPromise;Qt.exports={copy:Yi(Jt()),copySync:Gt()}});var we=p((Ns,zt)=>{"use strict";var Vt=se(),Ki=C().fromCallback;function Gi(e,t){Vt.rm(e,{recursive:!0,force:!0},t)}function Qi(e){Vt.rmSync(e,{recursive:!0,force:!0})}zt.exports={remove:Ki(Gi),removeSync:Qi}});var or=p((Ts,ir)=>{"use strict";var Vi=C().fromPromise,er=A(),tr=require("path"),rr=G(),nr=we(),Xt=Vi(async function(t){let r;try{r=await er.readdir(t)}catch{return rr.mkdirs(t)}return Promise.all(r.map(n=>nr.remove(tr.join(t,n))))});function Zt(e){let t;try{t=er.readdirSync(e)}catch{return rr.mkdirsSync(e)}t.forEach(r=>{r=tr.join(e,r),nr.removeSync(r)})}ir.exports={emptyDirSync:Zt,emptydirSync:Zt,emptyDir:Xt,emptydir:Xt}});var ur=p((Ls,ar)=>{"use strict";var zi=C().fromPromise,sr=require("path"),X=A(),cr=G();async function Xi(e){let t;try{t=await X.stat(e)}catch{}if(t&&t.isFile())return;let r=sr.dirname(e),n=null;try{n=await X.stat(r)}catch(i){if(i.code==="ENOENT"){await cr.mkdirs(r),await X.writeFile(e,"");return}else throw i}n.isDirectory()?await X.writeFile(e,""):await X.readdir(r)}function Zi(e){let t;try{t=X.statSync(e)}catch{}if(t&&t.isFile())return;let r=sr.dirname(e);try{X.statSync(r).isDirectory()||X.readdirSync(r)}catch(n){if(n&&n.code==="ENOENT")cr.mkdirsSync(r);else throw n}X.writeFileSync(e,"")}ar.exports={createFile:zi(Xi),createFileSync:Zi}});var dr=p((_s,yr)=>{"use strict";var eo=C().fromPromise,lr=require("path"),te=A(),fr=G(),{pathExists:to}=ee(),{areIdentical:mr}=ie();async function ro(e,t){let r;try{r=await te.lstat(t)}catch{}let n;try{n=await te.lstat(e)}catch(s){throw s.message=s.message.replace("lstat","ensureLink"),s}if(r&&mr(n,r))return;let i=lr.dirname(t);await to(i)||await fr.mkdirs(i),await te.link(e,t)}function no(e,t){let r;try{r=te.lstatSync(t)}catch{}try{let o=te.lstatSync(e);if(r&&mr(o,r))return}catch(o){throw o.message=o.message.replace("lstat","ensureLink"),o}let n=lr.dirname(t);return te.existsSync(n)||fr.mkdirsSync(n),te.linkSync(e,t)}yr.exports={createLink:eo(ro),createLinkSync:no}});var pr=p((Rs,hr)=>{"use strict";var re=require("path"),Se=A(),{pathExists:io}=ee(),oo=C().fromPromise;async function so(e,t){if(re.isAbsolute(e)){try{await Se.lstat(e)}catch(o){throw o.message=o.message.replace("lstat","ensureSymlink"),o}return{toCwd:e,toDst:e}}let r=re.dirname(t),n=re.join(r,e);if(await io(n))return{toCwd:n,toDst:e};try{await Se.lstat(e)}catch(o){throw o.message=o.message.replace("lstat","ensureSymlink"),o}return{toCwd:e,toDst:re.relative(r,e)}}function co(e,t){if(re.isAbsolute(e)){if(!Se.existsSync(e))throw new Error("absolute srcpath does not exist");return{toCwd:e,toDst:e}}let r=re.dirname(t),n=re.join(r,e);if(Se.existsSync(n))return{toCwd:n,toDst:e};if(!Se.existsSync(e))throw new Error("relative srcpath does not exist");return{toCwd:e,toDst:re.relative(r,e)}}hr.exports={symlinkPaths:oo(so),symlinkPathsSync:co}});var vr=p((Ms,Sr)=>{"use strict";var wr=A(),ao=C().fromPromise;async function uo(e,t){if(t)return t;let r;try{r=await wr.lstat(e)}catch{return"file"}return r&&r.isDirectory()?"dir":"file"}function lo(e,t){if(t)return t;let r;try{r=wr.lstatSync(e)}catch{return"file"}return r&&r.isDirectory()?"dir":"file"}Sr.exports={symlinkType:ao(uo),symlinkTypeSync:lo}});var kr=p((Is,Pr)=>{"use strict";var fo=C().fromPromise,gr=require("path"),Q=A(),{mkdirs:mo,mkdirsSync:yo}=G(),{symlinkPaths:ho,symlinkPathsSync:po}=pr(),{symlinkType:wo,symlinkTypeSync:So}=vr(),{pathExists:vo}=ee(),{areIdentical:xr}=ie();async function go(e,t,r){let n;try{n=await Q.lstat(t)}catch{}if(n&&n.isSymbolicLink()){let[a,y]=await Promise.all([Q.stat(e),Q.stat(t)]);if(xr(a,y))return}let i=await ho(e,t);e=i.toDst;let o=await wo(i.toCwd,r),s=gr.dirname(t);return await vo(s)||await mo(s),Q.symlink(e,t,o)}function xo(e,t,r){let n;try{n=Q.lstatSync(t)}catch{}if(n&&n.isSymbolicLink()){let a=Q.statSync(e),y=Q.statSync(t);if(xr(a,y))return}let i=po(e,t);e=i.toDst,r=So(i.toCwd,r);let o=gr.dirname(t);return Q.existsSync(o)||yo(o),Q.symlinkSync(e,t,r)}Pr.exports={createSymlink:fo(go),createSymlinkSync:xo}});var Cr=p((js,Dr)=>{"use strict";var{createFile:Fr,createFileSync:Er}=ur(),{createLink:qr,createLinkSync:br}=dr(),{createSymlink:$r,createSymlinkSync:Or}=kr();Dr.exports={createFile:Fr,createFileSync:Er,ensureFile:Fr,ensureFileSync:Er,createLink:qr,createLinkSync:br,ensureLink:qr,ensureLinkSync:br,createSymlink:$r,createSymlinkSync:Or,ensureSymlink:$r,ensureSymlinkSync:Or}});var $e=p((As,Nr)=>{function Po(e,{EOL:t=`
`,finalEOL:r=!0,replacer:n=null,spaces:i}={}){let o=r?t:"";return JSON.stringify(e,n,i).replace(/\n/g,t)+o}function ko(e){return Buffer.isBuffer(e)&&(e=e.toString("utf8")),e.replace(/^\uFEFF/,"")}Nr.exports={stringify:Po,stripBom:ko}});var Rr=p((Ws,_r)=>{var ue;try{ue=se()}catch{ue=require("fs")}var Oe=C(),{stringify:Tr,stripBom:Lr}=$e();async function Fo(e,t={}){typeof t=="string"&&(t={encoding:t});let r=t.fs||ue,n="throws"in t?t.throws:!0,i=await Oe.fromCallback(r.readFile)(e,t);i=Lr(i);let o;try{o=JSON.parse(i,t?t.reviver:null)}catch(s){if(n)throw s.message=`${e}: ${s.message}`,s;return null}return o}var Eo=Oe.fromPromise(Fo);function qo(e,t={}){typeof t=="string"&&(t={encoding:t});let r=t.fs||ue,n="throws"in t?t.throws:!0;try{let i=r.readFileSync(e,t);return i=Lr(i),JSON.parse(i,t.reviver)}catch(i){if(n)throw i.message=`${e}: ${i.message}`,i;return null}}async function bo(e,t,r={}){let n=r.fs||ue,i=Tr(t,r);await Oe.fromCallback(n.writeFile)(e,i,r)}var $o=Oe.fromPromise(bo);function Oo(e,t,r={}){let n=r.fs||ue,i=Tr(t,r);return n.writeFileSync(e,i,r)}var Do={readFile:Eo,readFileSync:qo,writeFile:$o,writeFileSync:Oo};_r.exports=Do});var Ir=p((Bs,Mr)=>{"use strict";var De=Rr();Mr.exports={readJson:De.readFile,readJsonSync:De.readFileSync,writeJson:De.writeFile,writeJsonSync:De.writeFileSync}});var Ce=p((Js,Wr)=>{"use strict";var Co=C().fromPromise,Ye=A(),jr=require("path"),Ar=G(),No=ee().pathExists;async function To(e,t,r="utf-8"){let n=jr.dirname(e);return await No(n)||await Ar.mkdirs(n),Ye.writeFile(e,t,r)}function Lo(e,...t){let r=jr.dirname(e);Ye.existsSync(r)||Ar.mkdirsSync(r),Ye.writeFileSync(e,...t)}Wr.exports={outputFile:Co(To),outputFileSync:Lo}});var Jr=p((Us,Br)=>{"use strict";var{stringify:_o}=$e(),{outputFile:Ro}=Ce();async function Mo(e,t,r={}){let n=_o(t,r);await Ro(e,n,r)}Br.exports=Mo});var Hr=p((Hs,Ur)=>{"use strict";var{stringify:Io}=$e(),{outputFileSync:jo}=Ce();function Ao(e,t,r){let n=Io(t,r);jo(e,n,r)}Ur.exports=Ao});var Kr=p((Ys,Yr)=>{"use strict";var Wo=C().fromPromise,B=Ir();B.outputJson=Wo(Jr());B.outputJsonSync=Hr();B.outputJSON=B.outputJson;B.outputJSONSync=B.outputJsonSync;B.writeJSON=B.writeJson;B.writeJSONSync=B.writeJsonSync;B.readJSON=B.readJson;B.readJSONSync=B.readJsonSync;Yr.exports=B});var Xr=p((Ks,zr)=>{"use strict";var Bo=A(),Gr=require("path"),{copy:Jo}=be(),{remove:Vr}=we(),{mkdirp:Uo}=G(),{pathExists:Ho}=ee(),Qr=ie();async function Yo(e,t,r={}){let n=r.overwrite||r.clobber||!1,{srcStat:i,isChangingCase:o=!1}=await Qr.checkPaths(e,t,"move",r);await Qr.checkParentPaths(e,i,t,"move");let s=Gr.dirname(t);return Gr.parse(s).root!==s&&await Uo(s),Ko(e,t,n,o)}async function Ko(e,t,r,n){if(!n){if(r)await Vr(t);else if(await Ho(t))throw new Error("dest already exists.")}try{await Bo.rename(e,t)}catch(i){if(i.code!=="EXDEV")throw i;await Go(e,t,r)}}async function Go(e,t,r){return await Jo(e,t,{overwrite:r,errorOnExist:!0,preserveTimestamps:!0}),Vr(e)}zr.exports=Yo});var nn=p((Gs,rn)=>{"use strict";var en=se(),Ge=require("path"),Qo=be().copySync,tn=we().removeSync,Vo=G().mkdirpSync,Zr=ie();function zo(e,t,r){r=r||{};let n=r.overwrite||r.clobber||!1,{srcStat:i,isChangingCase:o=!1}=Zr.checkPathsSync(e,t,"move",r);return Zr.checkParentPathsSync(e,i,t,"move"),Xo(t)||Vo(Ge.dirname(t)),Zo(e,t,n,o)}function Xo(e){let t=Ge.dirname(e);return Ge.parse(t).root===t}function Zo(e,t,r,n){if(n)return Ke(e,t,r);if(r)return tn(t),Ke(e,t,r);if(en.existsSync(t))throw new Error("dest already exists.");return Ke(e,t,r)}function Ke(e,t,r){try{en.renameSync(e,t)}catch(n){if(n.code!=="EXDEV")throw n;return es(e,t,r)}}function es(e,t,r){return Qo(e,t,{overwrite:r,errorOnExist:!0,preserveTimestamps:!0}),tn(e)}rn.exports=zo});var sn=p((Qs,on)=>{"use strict";var ts=C().fromPromise;on.exports={move:ts(Xr()),moveSync:nn()}});var an=p((Vs,cn)=>{"use strict";cn.exports={...A(),...be(),...or(),...Cr(),...Kr(),...G(),...sn(),...Ce(),...ee(),...we()}});var un,V,$,zs,ve,Qe,Xs,ln=U(()=>{"use strict";un=Xn(an(),1),V=require("node:fs"),$=require("node:fs/promises"),{removeSync:zs,mkdirp:ve,remove:Qe,copy:Xs}=un.default});function dn(e){return new Promise(t=>{setTimeout(()=>{t(!0)},e)})}function Ve(e=32){let t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890",r="";for(let n=0;n<e;n++)r+=t.charAt(Math.floor(Math.random()*t.length));return r}function le(){return hn==="darwin"}function Ne(){return hn==="linux"}var fn,mn,yn,f,hn,H=U(()=>{"use strict";ln();fn=require("child_process"),mn=require("util"),yn=require("node:os"),f=(0,mn.promisify)(fn.exec);hn=(0,yn.platform)()});var F,K=U(()=>{"use strict";H();F=class{exec(t,...r){let n=this?.[t];return n?n.call(this,...r):new Promise((i,o)=>{o(new Error("No Found Function"))})}startService(t,r={}){return new Promise(async(n,i)=>{try{await f(t,r)}catch(o){i(o);return}n(!0)})}}});var pn={};Y(pn,{default:()=>rs});var ze,Xe,Ze,rs,wn=U(()=>{"use strict";ze=require("node:path");H();Xe=require("node:fs");K();Ze=class extends F{writeFileByRoot(t,r){return new Promise(async(n,i)=>{let o=!1,s;try{await(0,$.writeFile)(t,r)}catch(a){o=!0,s=a}if(o){let a=(0,ze.join)("/tmp",`${Ve()}.txt`);await(0,$.writeFile)(a,r);try{await f(`cp -f "${a}" "${t}"`),o=!1}catch(y){s=y}try{await f(`rm -rf "${a}"`)}catch{}}if(o){i(s);return}n(!0)})}readFileByRoot(t){return new Promise(async(r,n)=>{let i="",o,s=!1;try{i=await(0,$.readFile)(t,"utf-8")}catch(a){o=a,s=!0}if(s){let a=(0,ze.join)(global.Server.Cache,`${Ve()}.txt`);try{await f(`cp -f "${t}" "${a}"`),i=await(0,$.readFile)(a,"utf-8"),await f(`rm -rf "${a}"`),s=!1}catch(y){o=y,s=!0}}if(s)return n(o);r(i)})}processList(){return new Promise(async t=>{let r="";try{r=(await f("ps axo user,pid,ppid,command")).stdout}catch{}return t(r?r.trim().split(`
`).filter(n=>!!n.trim()).map(n=>{let i=n.split(" ").filter(g=>!!g.trim()),o=i.shift(),s=i.shift(),a=i.shift(),y=i.join(" ");return{USER:o,PID:s,PPID:a,COMMAND:y}}):[])})}rm(t){return new Promise(async r=>{try{await f(`rm -rf "${t}"`)}catch{}r(!0)})}chmod(t,r){return new Promise(async n=>{if((0,Xe.existsSync)(t))try{await f(`chmod ${r} "${t}"`)}catch{}n(!0)})}kill(t,r){return new Promise(async n=>{try{await f(`kill ${t} ${r.join(" ")}`)}catch{}n(!0)})}ln_s(t,r){return new Promise(async n=>{if((0,Xe.existsSync)(t))try{await f(`ln -s "${t}" "${r}"`)}catch{}n(!0)})}killPorts(t){return new Promise(async r=>{let n=new Set;for(let i of t){let o=await f(`lsof -nP -i:${i} | grep '(LISTEN)' | awk '{print $1,$2,$3,$9,$10}'`);o=o?.stdout??"",o.split(`
`).filter(a=>a.includes(`:${i} (LISTEN)`)).map(a=>{let y=a.split(" ").filter(g=>g.trim().length>0);return y.shift(),y.shift()}).forEach(a=>n.add(a))}if(n.size>0)try{await f(["kill","-9",...Array.from(n)].join(" "))}catch{}r(!0)})}getPortPids(t){return new Promise(async r=>{let i=(await f(`lsof -nP -i:${t} | awk '{print $1,$2,$3}'`)).stdout.toString().trim().split(`
`).filter((o,s)=>s>0).map(o=>{let s=o.split(" ").filter(c=>c.trim().length>0),a=s.pop(),y=s.pop(),g=s.join(" ");return{USER:a,PID:y,COMMAND:g}});r(i)})}},rs=new Ze});var Sn={};Y(Sn,{default:()=>ns});var et,ns,vn=U(()=>{"use strict";K();H();et=class extends F{macportsDirFixed(t,r){return new Promise(async n=>{try{await f(`mkdir -p ${t}`),await f(`cp -R ${r} ${t}`)}catch{}n(!0)})}},ns=new et});var xn={};Y(xn,{default:()=>is});var gn,tt,is,Pn=U(()=>{"use strict";gn=require("node:fs");K();H();tt=class extends F{sslDirFixed(t){return new Promise(async r=>{if((0,gn.existsSync)(t))try{(await f(["ls","-al",t].join(" "))).stdout.includes(" root ")&&await f(["rm","-rf",t].join(" "))}catch{}r(!0)})}},is=new tt});var Fn={};Y(Fn,{default:()=>os});var kn,rt,os,En=U(()=>{"use strict";kn=require("node:fs");K();H();rt=class extends F{logFileFixed(t,r){return new Promise(async n=>{(0,kn.existsSync)(t)&&await f(`chown ${r} ${t}`),n(!0)})}},os=new rt});var bn={};Y(bn,{default:()=>ss});var qn,nt,ss,$n=U(()=>{"use strict";K();qn=require("node:path");H();nt=class extends F{iniFileFixed(t,r){return new Promise(async n=>{await ve((0,qn.dirname)(t)),await f(`cp -f "${r}" "${t}"`),await f(`chmod 755 "${t}"`),n(!0)})}iniDefaultFileFixed(t,r){return new Promise(async n=>{await f(`cp -f "${r}" "${t}"`),n(!0)})}},ss=new nt});var Dn={};Y(Dn,{default:()=>cs});var On,it,cs,Cn=U(()=>{"use strict";On=require("node:fs");K();H();it=class extends F{binFixed(t){return new Promise(async r=>{if(le()&&(0,On.existsSync)(t))try{await f(`xattr -dr "com.apple.quarantine" "${t}"`)}catch{}r(!0)})}},cs=new it});var Nn={};Y(Nn,{default:()=>as});var ot,as,Tn=U(()=>{"use strict";K();H();ot=class extends F{macportsDirFixed(t,r,n,i){return new Promise(async o=>{try{await f(`mkdir -p "${t}"`),await f(`cp -R "${r}/*" "${t}"`),await f(`mkdir -p "${n}"`),await f(`cp -R "${i}" "${n}"`)}catch{}o(!0)})}},as=new ot});var Ln={};Y(Ln,{default:()=>us});var st,us,_n=U(()=>{"use strict";K();st=class extends F{},us=new st});var Rn={};Y(Rn,{default:()=>ls});var ct,ls,Mn=U(()=>{"use strict";K();H();ct=class extends F{initPlugin(t){return new Promise(async(r,n)=>{try{await f("./rabbitmq-plugins enable rabbitmq_management",{cwd:t})}catch(i){n(i);return}r(!0)})}},ls=new ct});var jn={};Y(jn,{default:()=>fs});var In,at,fs,An=U(()=>{"use strict";K();H();In=require("node:path"),at=class extends F{async sslAddTrustedCert(t,r){if(le())await f(`security add-trusted-cert -d -r trustRoot -k "/Library/Keychains/System.keychain" "${r}"`,{cwd:t});else if(Ne()){let n=(0,In.join)(t,r),i=`/usr/local/share/ca-certificates/${r}`,o=`/etc/pki/ca-trust/source/anchors/${r}`,s=!1;try{await f(`sudo cp "${n}" "${i}"`),await f("sudo update-ca-certificates")}catch{s=!0}if(s)try{await f(`sudo cp "${n}" "${o}"`),await f("sudo update-ca-trust extract")}catch{}}return!0}async sslFindCertificate(t,r="FlyEnv-Root-CA"){try{if(le()){let n=await f(`security find-certificate -c "${r}"`,{cwd:t});return{stdout:n.stdout,stderr:n.stderr}}else if(Ne()){let n=["/etc/ssl/certs/","/usr/local/share/ca-certificates/","/etc/pki/ca-trust/extracted/pem/","/etc/pki/tls/certs/"],i="";for(let o of n)try{let{stdout:s}=await f(`find "${o}" -name "*.crt" -print 2>/dev/null`),a=s.split(`
`).map(y=>y.trim()).filter(y=>!!y);for(let y of a)try{let{stdout:g}=await f(`openssl x509 -in "${y}" -text -noout`);if(g.includes(`CN = ${r}`)){i=y;break}}catch{}if(i)break}catch{}return i?{stdout:`Found certificate: ${i}
`,stderr:""}:{stdout:"",stderr:`Certificate with CN "${r}" not found on Linux.`}}return{stdout:"",stderr:""}}catch(n){return{stdout:"",stderr:`${n}`}}}async dnsRefresh(){try{if(le()){try{await f("dscacheutil -flushcache")}catch{}try{await f("killall -HUP mDNSResponder")}catch{}}else if(Ne()){try{return await f("sudo systemctl restart systemd-resolved.service"),!0}catch{}try{return await f("sudo systemctl restart nscd.service"),!0}catch{}try{return await f("sudo systemctl restart dnsmasq.service"),!0}catch{}}}catch{}return!0}},fs=new at});var Wn={};Y(Wn,{default:()=>ms});var ut,ms,Bn=U(()=>{"use strict";K();ut=class extends F{},ms=new ut});var ds={};Y(ds,{default:()=>ys});module.exports=Zn(ds);var Un=require("node:net");H();H();var ge="/tmp/flyenv-helper.sock",Jn="/tmp/flyenv.role",Te="/usr/local/share/FlyEnv/flyenv.role",lt=class{Tool;MariaDB;Caddy;Redis;PHP;Mailpit;Mysql;Apache;RabbitMQ;Host;Nginx;async init(){(0,V.existsSync)(ge)&&await Qe(ge);let t=(0,Un.createServer)(r=>{let n=[];r.on("data",async i=>{n.push(i);let o;try{let s=Buffer.concat(n).toString().trim();o=JSON.parse(s)}catch{}if(o){n.splice(0);let s=o.key,a=o.module,y=o.function,g=o?.args??[],c=u=>{u.exec(y,...g)?.then(m=>{let l={key:s,code:0,data:m};r.write(JSON.stringify(l),d=>{})})?.catch(m=>{let l={key:s,code:1,msg:`${m}`};r.write(JSON.stringify(l))})};if(a==="tools"){if(!this.Tool){let u=await Promise.resolve().then(()=>(wn(),pn));this.Tool=u.default}c(this.Tool)}else if(a==="mariadb"){if(!this.MariaDB){let u=await Promise.resolve().then(()=>(vn(),Sn));this.MariaDB=u.default}c(this.MariaDB)}else if(a==="caddy"){if(!this.Caddy){let u=await Promise.resolve().then(()=>(Pn(),xn));this.Caddy=u.default}c(this.Caddy)}else if(a==="redis"){if(!this.Redis){let u=await Promise.resolve().then(()=>(En(),Fn));this.Redis=u.default}c(this.Redis)}else if(a==="php"){if(!this.PHP){let u=await Promise.resolve().then(()=>($n(),bn));this.PHP=u.default}c(this.PHP)}else if(a==="mailpit"){if(!this.Mailpit){let u=await Promise.resolve().then(()=>(Cn(),Dn));this.Mailpit=u.default}c(this.Mailpit)}else if(a==="mysql"){if(!this.Mysql){let u=await Promise.resolve().then(()=>(Tn(),Nn));this.Mysql=u.default}c(this.Mysql)}else if(a==="apache"){if(!this.Apache){let u=await Promise.resolve().then(()=>(_n(),Ln));this.Apache=u.default}c(this.Apache)}else if(a==="rabbitmq"){if(!this.RabbitMQ){let u=await Promise.resolve().then(()=>(Mn(),Rn));this.RabbitMQ=u.default}c(this.RabbitMQ)}else if(a==="host"){if(!this.Host){let u=await Promise.resolve().then(()=>(An(),jn));this.Host=u.default}c(this.Host)}else if(a==="nginx"){if(!this.Nginx){let u=await Promise.resolve().then(()=>(Bn(),Wn));this.Nginx=u.default}c(this.Nginx)}}}),r.on("end",()=>{try{r.destroySoon()}catch{}})});t.listen(ge,async()=>{await dn(500);let r="";(0,V.existsSync)(Jn)?(r=await(0,$.readFile)(Jn,"utf8"),await ve(Te),await(0,$.writeFile)(Te,r)):(0,V.existsSync)(Te)&&(r=await(0,$.readFile)(Te,"utf8")),r&&(0,V.existsSync)(ge)&&await f(`chown ${r.trim()} "${ge}"`)}),t.on("error",r=>{})}},Hn=new lt;Hn.init().then().catch();var ys=Hn;
